# Calculate when 1s Changes to 0 (Do same for industry)
##### JCTC
## Calculating which year would be best for "treatment" and Building Up Table for Explanation
Incentives$JCTC_Dum_CumSum <- ave(Incentives$JCTC_Dum, Incentives$State, Incentives$Industry, FUN=cumsum)
IncenChY_JCTC <- Incentives[Incentives$JCTC_Dum_CumSum == 1,]
names(IncenChY_JCTC)
IncenChY_JCTC_YearAgg <- as.data.frame(aggregate(. ~ Base.Year, IncenChY_JCTC[c(7, 22)], sum))
IncenChY_JCTC_YearAgg <- IncenChY_JCTC_YearAgg[IncenChY_JCTC_YearAgg$Base.Year > 1996,]
IncenChY_JCTC_YearAgg$Base.Year[which.max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum)]
JCTC1 <-
JCTC2 <- max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum)
# How many states in that year?
JCTC3 <- length(unique(Incentives[Incentives$Base.Year == 2004 & Incentives$JCTC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_JCTC_control <- Incentives[Incentives$JCTC_Dum_CumSum == 0,]
sum(IncenChy_JCTC_control$JCTC_Dum_CumSum == 0 & IncenChy_JCTC_control$Base.Year == 2015)
length(unique(IncenChy_JCTC_control[IncenChy_JCTC_control$JCTC_Dum_CumSum == 0 & IncenChy_JCTC_control$Base.Year == 2015,]$State))
# The Year with the most policy adoptions for JCTC is 1996. In this year, 155 industries across 5 states adopted JCTC. Would be able to potentially compare against 637 in 30 states that never adopt.
# If we look at just post 1997 when the data merges, 2004 appears to bt the best year. In this year, 62  industries across states adopted JCTC. Would be able to potentially compare against 637 in 30 states that never adopt.
###### ITC
Incentives$ITC_Dum_CumSum <- ave(Incentives$ITC_Dum, Incentives$State, Incentives$Industry, FUN=cumsum)
IncenChY_ITC <- Incentives[Incentives$ITC_Dum_CumSum == 1,]
names(IncenChY_ITC)
IncenChY_ITC_YearAgg <- as.data.frame(aggregate(. ~ Base.Year, IncenChY_ITC[c(7, 23)], sum))
IncenChY_ITC_YearAgg <- IncenChY_ITC_YearAgg[IncenChY_ITC_YearAgg$Base.Year > 1996,]
IncenChY_ITC_YearAgg$Base.Year[which.max(IncenChY_ITC_YearAgg$ITC_Dum_CumSum)]
max(IncenChY_ITC_YearAgg$ITC_Dum_CumSum)
# How many states in that year?
length(unique(Incentives[Incentives$Base.Year == 1998 & Incentives$ITC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_ITC_control <- Incentives[Incentives$ITC_Dum_CumSum == 0,]
sum(IncenChy_ITC_control$ITC_Dum_CumSum == 0 & IncenChy_ITC_control$Base.Year == 2015)
length(unique(IncenChy_ITC_control[IncenChy_ITC_control$ITC_Dum_CumSum == 0 & IncenChy_ITC_control$Base.Year == 2015,]$State))
# The Year with the most policy adoptions for ITC is 1995. In this year, 100 industries across 4 states adopted ITC. Could compare against 865 in 31 states that never adopt.
##### RDC
Incentives$RDC_Dum_CumSum <- ave(Incentives$RDC_Dum, Incentives$State, Incentives$Industry, FUN=cumsum)
IncenChY_RDC <- Incentives[Incentives$RDC_Dum_CumSum == 1,]
names(IncenChY_RDC)
IncenChY_RDC_YearAgg <- as.data.frame(aggregate(. ~ Base.Year, IncenChY_RDC[c(7, 24)], sum))
IncenChY_RDC_YearAgg <- IncenChY_RDC_YearAgg[IncenChY_RDC_YearAgg$Base.Year != 1990,]
IncenChY_RDC_YearAgg$Base.Year[which.max(IncenChY_RDC_YearAgg$RDC_Dum_CumSum)]
max(IncenChY_RDC_YearAgg$RDC_Dum_CumSum)
# How many states in that year?
length(unique(Incentives[Incentives$Base.Year == 2000 & Incentives$RDC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_RDC_control <- Incentives[Incentives$RDC_Dum_CumSum == 0,]
sum(IncenChy_RDC_control$RDC_Dum_CumSum == 0 & IncenChy_RDC_control$Base.Year == 2015)
length(unique(IncenChy_RDC_control[IncenChy_RDC_control$RDC_Dum_CumSum == 0 & IncenChy_RDC_control$Base.Year == 2015,]$State))
# The Year with the most policy adoptions for RDC is 2000. In this year, 134 industries across 4 states adopted RDC. Could compare against 460 across 25 states that never adopt.
##### PTA
Incentives$PTA_Dum_CumSum <- ave(Incentives$PTA_Dum, Incentives$State, Incentives$Industry, FUN=cumsum)
IncenChY_PTA <- Incentives[Incentives$PTA_Dum_CumSum == 1,]
names(IncenChY_PTA)
IncenChY_PTA_YearAgg <- as.data.frame(aggregate(. ~ Base.Year, IncenChY_PTA[c(7, 25)], sum))
IncenChY_PTA_YearAgg <- IncenChY_PTA_YearAgg[IncenChY_PTA_YearAgg$Base.Year != 1990,]
IncenChY_PTA_YearAgg$Base.Year[which.max(IncenChY_PTA_YearAgg$PTA_Dum_CumSum)]
max(IncenChY_PTA_YearAgg$PTA_Dum_CumSum)
# How many states in that year?
length(unique(Incentives[Incentives$Base.Year == 1994 & Incentives$PTA_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_PTA_control <- Incentives[Incentives$PTA_Dum_CumSum == 0,]
sum(IncenChy_PTA_control$PTA_Dum_CumSum == 0 & IncenChy_PTA_control$Base.Year == 2015)
length(unique(IncenChy_PTA_control[IncenChy_PTA_control$PTA_Dum_CumSum == 0 & IncenChy_PTA_control$Base.Year == 2015,]$State))
# The Year with the most policy adoptions for PTA is 1994. In this year, 45 industries in 1 state adopted PTA. Could compare against 927 across 28 states that never adopted.
# CJTS
Incentives$CJTS_Dum_CumSum <- ave(Incentives$CJTS_Dum, Incentives$State, Incentives$Industry, FUN=cumsum)
IncenChY_CJTS <- Incentives[Incentives$CJTS_Dum_CumSum == 1,]
names(IncenChY_CJTS)
IncenChY_CJTS_YearAgg <- as.data.frame(aggregate(. ~ Base.Year, IncenChY_CJTS[c(7, 26)], sum))
IncenChY_CJTS_YearAgg <- IncenChY_CJTS_YearAgg[IncenChY_CJTS_YearAgg$Base.Year != 1990,]
IncenChY_CJTS_YearAgg$Base.Year[which.max(IncenChY_CJTS_YearAgg$CJTS_Dum_CumSum)]
max(IncenChY_CJTS_YearAgg$CJTS_Dum_CumSum)
# How many states in that year?
length(unique(Incentives[Incentives$Base.Year == 1993 & Incentives$CJTS_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_CJTS_control <- Incentives[Incentives$CJTS_Dum_CumSum == 0,]
sum(IncenChy_CJTS_control$CJTS_Dum_CumSum == 0 & IncenChy_CJTS_control$Base.Year == 2015)
length(unique(IncenChy_CJTS_control[IncenChy_CJTS_control$CJTS_Dum_CumSum == 0 & IncenChy_CJTS_control$Base.Year == 2015,]$State))
# The Year with the most policy adoptions for CJTS is 1993. In this year, 93 industries across 3 states adopted CJTS. Could compare against 599 in 27 states that never adopted.
# Aggregate for State and See if At Least Some Industries Have
Incentives_StateAgg <- as.data.frame(aggregate(. ~ State + Base.Year, Incentives[c(1, 7, 17:21)], sum))
# Create Dummies to signify no incentives vs incentives (regardless of degree)
Incentives_StateAgg$JCTC_DumState <- ifelse((Incentives_StateAgg$JCTC_Dum > 0), 1, 0)
Incentives_StateAgg$ITC_DumState <- ifelse((Incentives_StateAgg$ITC_Dum > 0), 1, 0)
Incentives_StateAgg$RDC_DumState <- ifelse((Incentives_StateAgg$RDC_Dum > 0), 1, 0)
Incentives_StateAgg$PTA_DumState <- ifelse((Incentives_StateAgg$PTA_Dum > 0), 1, 0)
Incentives_StateAgg$CJTS_DumState <- ifelse((Incentives_StateAgg$CJTS_Dum > 0), 1, 0)
table(Incentives_StateAgg$JCTC_DumState)
# Load in data
FullIncGSP_9715 <- read.csv("Full Merged Dataset NAICS 102518.csv", stringsAsFactors = FALSE)
# JCTC
IncenChY_JCTC <- FullIncGDP_9715[FullIncGDP_9715$JCTC_Dum_CumSum == 1,]
names(IncenChY_JCTC)
IncenChY_JCTC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_JCTC[c(7, 22)], sum))
IncenChY_JCTC_YearAgg$Year[which.max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum)]
JCTC1 <- 2004
JCTC2 <- max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum[IncenChY_JCTC_YearAgg$Year == 2004])
setwd("~/GeorgetownMPPMSFS/McCourtMPP/Semester5Fall2018/Thesis/BEA State Industry GDP Data")
# Load in all years of data and then cbind to get the time series
allfilesbea2 <- list.files(path = "./NAICS Classified", pattern="*.csv", full.names = TRUE)
datalist = list()
for (i in allfilesbea2) {
# ... make some data
dat <- read.csv(i, header = TRUE, na.strings = c("", "(L)"))
datalist[[i]] <- dat # add it to your list
}
big_data2 = do.call(cbind, datalist)
# Clean up data
big_data2 <- big_data2[big_data2$`./NAICS Classified/1997 BEA.csv.Industry` != "Addenda:",]
drop2 <- c("./NAICS Classified/2015 BEA.csv.Industry", "./NAICS Classified/2014 BEA.csv.Industry", "./NAICS Classified/2013 BEA.csv.Industry", "./NAICS Classified/2012 BEA.csv.Industry", "./NAICS Classified/2011 BEA.csv.Industry", "./NAICS Classified/2010 BEA.csv.Industry", "./NAICS Classified/2009 BEA.csv.Industry", "./NAICS Classified/2008 BEA.csv.Industry", "./NAICS Classified/2007 BEA.csv.Industry", "./NAICS Classified/2006 BEA.csv.Industry", "./NAICS Classified/2005 BEA.csv.Industry", "./NAICS Classified/2004 BEA.csv.Industry", "./NAICS Classified/2003 BEA.csv.Industry", "./NAICS Classified/2002 BEA.csv.Industry", "./NAICS Classified/2001 BEA.csv.Industry", "./NAICS Classified/2000 BEA.csv.Industry", "./NAICS Classified/1999 BEA.csv.Industry", "./NAICS Classified/1998 BEA.csv.Industry", "./NAICS Classified/2015 BEA.csv.Area", "./NAICS Classified/2014 BEA.csv.Area", "./NAICS Classified/2013 BEA.csv.Area", "./NAICS Classified/2012 BEA.csv.Area", "./NAICS Classified/2011 BEA.csv.Area", "./NAICS Classified/2010 BEA.csv.Area", "./NAICS Classified/2009 BEA.csv.Area", "./NAICS Classified/2008 BEA.csv.Area", "./NAICS Classified/2007 BEA.csv.Area", "./NAICS Classified/2006 BEA.csv.Area", "./NAICS Classified/2005 BEA.csv.Area", "./NAICS Classified/2004 BEA.csv.Area", "./NAICS Classified/2003 BEA.csv.Area", "./NAICS Classified/2002 BEA.csv.Area", "./NAICS Classified/2001 BEA.csv.Area", "./NAICS Classified/2000 BEA.csv.Area", "./NAICS Classified/1999 BEA.csv.Area", "./NAICS Classified/1998 BEA.csv.Area", "./NAICS Classified/2015 BEA.csv.Fips", "./NAICS Classified/2014 BEA.csv.Fips", "./NAICS Classified/2013 BEA.csv.Fips", "./NAICS Classified/2012 BEA.csv.Fips", "./NAICS Classified/2011 BEA.csv.Fips", "./NAICS Classified/2010 BEA.csv.Fips", "./NAICS Classified/2009 BEA.csv.Fips", "./NAICS Classified/2008 BEA.csv.Fips", "./NAICS Classified/2007 BEA.csv.Fips", "./NAICS Classified/2006 BEA.csv.Fips", "./NAICS Classified/2005 BEA.csv.Fips", "./NAICS Classified/2004 BEA.csv.Fips", "./NAICS Classified/2003 BEA.csv.Fips", "./NAICS Classified/2002 BEA.csv.Fips", "./NAICS Classified/2001 BEA.csv.Fips", "./NAICS Classified/2000 BEA.csv.Fips", "./NAICS Classified/1999 BEA.csv.Fips", "./NAICS Classified/1998 BEA.csv.Fips", "./NAICS Classified/2015 BEA.csv.IndCode", "./NAICS Classified/2014 BEA.csv.IndCode", "./NAICS Classified/2013 BEA.csv.IndCode", "./NAICS Classified/2012 BEA.csv.IndCode", "./NAICS Classified/2011 BEA.csv.IndCode", "./NAICS Classified/2010 BEA.csv.IndCode", "./NAICS Classified/2009 BEA.csv.IndCode", "./NAICS Classified/2008 BEA.csv.IndCode", "./NAICS Classified/2007 BEA.csv.IndCode", "./NAICS Classified/2006 BEA.csv.IndCode", "./NAICS Classified/2005 BEA.csv.IndCode", "./NAICS Classified/2004 BEA.csv.IndCode", "./NAICS Classified/2003 BEA.csv.IndCode", "./NAICS Classified/2002 BEA.csv.IndCode", "./NAICS Classified/2001 BEA.csv.IndCode", "./NAICS Classified/2000 BEA.csv.IndCode", "./NAICS Classified/1999 BEA.csv.IndCode", "./NAICS Classified/1998 BEA.csv.IndCode")
big_data2 <- big_data2[,!(names(big_data2) %in% drop2)]
names(big_data2) <- c("Fips", "Area", "IndCode", "Industry", "1997", "1998", "1999", "2000", "2001", "2002", "2003",  "2004", "2005", "2006", "2007", "2008", "2009", "2010", "2011", "2012", "2013", "2014", "2015")
############## Merge Incentives and BLS Data ###################
Incentives2 <- Incentives
Incentives2$Industry[Incentives2$Industry == "Broadcasting and Telecommunications"] <- c("Broadcasting (except Internet) and telecommunications")
Incentives2$Industry[Incentives2$Industry == "Food, beverage, and tobacco Manufacturing
"] <- c("Food and beverage and tobacco products manufacturing")
Incentives2$Industry[Incentives2$Industry == "furniture and related product manufacturing"] <- c("Furniture and related product manufacturing")
Incentives2$Industry[Incentives2$Industry == "Information and data processing services"] <- c("Information")
Incentives2$Industry[Incentives2$Industry == "Management of companies (holding companies)"] <- c("Management of companies and enterprises")
Incentives2$Industry[Incentives2$Industry == "miscellaneous manufacturing"] <- c("Miscellaneous manufacturing")
Incentives2$Industry[Incentives2$Industry == "Motor Vehicles, bodies and trailers, and parts"] <- c("Motor vehicles, bodies and trailers, and parts manufacturing")
Incentives2$Industry[Incentives2$Industry == "Motor Vehicles, bodies and trailers, and parts"] <- c("Motor vehicles, bodies and trailers, and parts manufacturing")
Incentives2$Industry[Incentives2$Industry == "Rental and leasing services and lessors of intangible assets"] <- c("Rental and leasing services and lessors of nonfinancial intangible assets")
Incentives2$Industry[Incentives2$Industry == "Securities, commodity contracts, other financial investments, and related activities"] <- c("Securities, commodity contracts, and other financial investments and related activities")
Incentives2$Industry[Incentives2$Industry == "Textile Mills and textile product mills
"] <- c("Textile mills and textile product mills")
Incentives2$Industry[Incentives2$Industry == "warehousing and storeage"] <- c("Warehousing and storage")
Incentives2$Industry[Incentives2$Industry == "Food, beverage, and tobacco Manufacturing"] <- c("Food and beverage and tobacco products manufacturing")
Incentives2$Industry[Incentives2$Industry == "Other Services"] <- c("Other services (except government and government enterprises)")
Incentives$Industry[Incentives$Industry == "Other Transportation Equipment"] <- c("Other transportation and support activities")
Incentives2$Industry[Incentives2$Industry == "Apparel, Leather and allied product Manufacturing"] <- c("Apparel, leather, and allied product manufacturing")
Incentives2$Industry[Incentives2$Industry == "Fabricated Metal Product Manufacturing"] <- c("Fabricated metal product manufacturing")
Incentives2$Industry[Incentives2$Industry == "Food, beverage, and tobacco Manufacturing"] <- c("Food and beverage and tobacco products manufacturing")
Incentives2$Industry[Incentives2$Industry == "Paper Manufacturing"] <- c("Paper manufacturing")
Incentives2$Industry[Incentives2$Industry == "Performing arts, spectator sports, museums and entertainment"] <- c("Performing arts, spectator sports, museums, and related activities")
Incentives2$Industry[Incentives2$Industry == "Plastics and Rubber products manufacturing
"] <- c("Plastics and rubber products manufacturing")
Incentives2$Industry[Incentives2$Industry == "Primary Metal Manufacturing"] <- c("Primary metal manufacturing")
Incentives2$Industry[Incentives2$Industry == "Publishing industries (includes software)"] <- c("Publishing industries (except Internet)")
Incentives2$Industry[Incentives2$Industry == "Waste Management and remediation services"] <- c("Waste management and remediation services")
Incentives2$Industry[Incentives2$Industry == "Wood Product Manufacturing"] <- c("Wood product manufacturing")
Incentives2$Industry[Incentives2$Industry == "Retail Trade"] <- c("Retail trade")
# Convert BEA/BLS dataset from wide to long
BEABLS_long <- reshape(big_data2, varying = list(names(big_data2)[5:23]), idvar = 'ID',
v.names = 'GDP', direction = 'long', timevar = "Year", times =1997:2015)
# Merge on State-Industry-Year
# Incentives Vars: State-Industry-Base.Year
# Big_data2 (BEA/BLS) Vars: Area- Industry - Year
# Change var names to match
names(BEABLS_long)[2] <- "State"
names(Incentives2)[7] <- "Year"
StateAbbrevs <- read_dta("state_name_abbreviation.dta")
library(haven)
StateAbbrevs <- read_dta("state_name_abbreviation.dta")
names(StateAbbrevs)[1] <- "State"
BEABLS_longst <- left_join(BEABLS_long, StateAbbrevs, by = "State")
names(BEABLS_longst)[2] <- "StateFull"
names(BEABLS_longst)[8] <- "State"
BEABLS_longst$Industry <- trimws(BEABLS_longst$Industry, which = "both")
# Export and Check Text of Industry Names
unique(BEABLS_longst$Industry)
unique(Incentives2$Industry)
BEABLS_longststates <- BEABLS_longst[BEABLS_longst$Industry == "All industry total",]
FullIncGDP_9015 <- left_join(Incentives2, BEABLS_longst, by = c("State", "Industry", "Year"))
FullIncGDP_9715 <- FullIncGDP_9015[FullIncGDP_9015$Year > 1996,]
FullIncGDP_9715 <- FullIncGDP_9715[!is.na(FullIncGDP_9715$GDP),]
# Load in data
FullIncGSP_9715 <- read.csv("Full Merged Dataset NAICS 102518.csv", stringsAsFactors = FALSE)
# JCTC
IncenChY_JCTC <- FullIncGDP_9715[FullIncGDP_9715$JCTC_Dum_CumSum == 1,]
names(IncenChY_JCTC)
IncenChY_JCTC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_JCTC[c(7, 22)], sum))
IncenChY_JCTC_YearAgg$Year[which.max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum)]
JCTC1 <- 2004
JCTC2 <- max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum[IncenChY_JCTC_YearAgg$Year == 2004])
# How many states in that year?
JCTC3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 2004 & FullIncGDP_9715$JCTC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_JCTC_control <- FullIncGDP_9715[FullIncGDP_9715$JCTC_Dum_CumSum == 0,]
JCTC4 <- sum(IncenChy_JCTC_control$JCTC_Dum_CumSum == 0 & IncenChy_JCTC_control$Year == 2015)
JCTC5 <- length(unique(IncenChy_JCTC_control[IncenChy_JCTC_control$JCTC_Dum_CumSum == 0 & IncenChy_JCTC_control$Year == 2015,]$State))
# If we look at just post 1997 when the data merges, 2004 appears to bt the best year. In this year, 62  industries across states adopted JCTC. Would be able to potentially compare against 637 in 30 states that never adopt.
Incentive <- "JCTC"
DiD_Year <- JCTC1
Treatment_Industries <- JCTC2
Treatment_States <- JCTC3
Control_Industries <- JCTC4
Control_States <- JCTC5
DiDEstimators1 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
###### ITC
IncenChY_ITC <- FullIncGDP_9715[FullIncGDP_9715$ITC_Dum_CumSum == 1,]
names(IncenChY_ITC)
IncenChY_ITC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_ITC[c(7, 23)], sum))
IncenChY_ITC_YearAgg <- IncenChY_ITC_YearAgg[IncenChY_ITC_YearAgg$Year > 1996,]
ITC1 <- IncenChY_ITC_YearAgg$Year[which.max(IncenChY_ITC_YearAgg$ITC_Dum_CumSum)]
ITC2 <- max(IncenChY_ITC_YearAgg$ITC_Dum_CumSum)
# How many states in that year?
ITC3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 1998 & FullIncGDP_9715$ITC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_ITC_control <- FullIncGDP_9715[FullIncGDP_9715$ITC_Dum_CumSum == 0,]
ITC4 <- sum(IncenChy_ITC_control$ITC_Dum_CumSum == 0 & IncenChy_ITC_control$Year == 2015)
ITC5 <- length(unique(IncenChy_ITC_control[IncenChy_ITC_control$ITC_Dum_CumSum == 0 & IncenChy_ITC_control$Year == 2015,]$State))
# The Year with the most policy adoptions for ITC is 1995. In this year, 100 industries across 4 states adopted ITC. Could compare against 865 in 31 states that never adopt.
Incentive <- "ITC"
DiD_Year <- ITC1
Treatment_Industries <- ITC2
Treatment_States <- ITC3
Control_Industries <- ITC4
Control_States <- ITC5
DiDEstimators2 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
##### RDC
IncenChY_RDC <- FullIncGDP_9715[FullIncGDP_9715$RDC_Dum_CumSum == 1,]
names(IncenChY_RDC)
IncenChY_RDC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_RDC[c(7, 24)], sum))
IncenChY_RDC_YearAgg <- IncenChY_RDC_YearAgg[IncenChY_RDC_YearAgg$Year > 1996,]
RDC1 <- IncenChY_RDC_YearAgg$Year[which.max(IncenChY_RDC_YearAgg$RDC_Dum_CumSum)]
RDC2 <- max(IncenChY_RDC_YearAgg$RDC_Dum_CumSum)
# How many states in that year?
RDC3 <- length(unique(Incentives[FullIncGDP_9715$Year == 2000 & FullIncGDP_9715$RDC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_RDC_control <- FullIncGDP_9715[FullIncGDP_9715$RDC_Dum_CumSum == 0,]
RDC4 <- sum(IncenChy_RDC_control$RDC_Dum_CumSum == 0 & IncenChy_RDC_control$Year == 2015)
RDC5 <- length(unique(IncenChy_RDC_control[IncenChy_RDC_control$RDC_Dum_CumSum == 0 & IncenChy_RDC_control$Year == 2015,]$State))
# The Year with the most policy adoptions for RDC is 2000. In this year, 134 industries across 4 states adopted RDC. Could compare against 460 across 25 states that never adopt.
Incentive <- "RDC"
DiD_Year <- RDC1
Treatment_Industries <- RDC2
Treatment_States <- RDC3
Control_Industries <- RDC4
Control_States <- RDC5
DiDEstimators3 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
##### PTA
IncenChY_PTA <- FullIncGDP_9715[FullIncGDP_9715$PTA_Dum_CumSum == 1,]
names(IncenChY_PTA)
IncenChY_PTA_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_PTA[c(7, 25)], sum))
IncenChY_PTA_YearAgg <- IncenChY_PTA_YearAgg[IncenChY_PTA_YearAgg$Year > 1996,]
IncenChY_PTA_YearAgg$Year[which.max(IncenChY_PTA_YearAgg$PTA_Dum_CumSum)]
PTA2 <- max(IncenChY_PTA_YearAgg$PTA_Dum_CumSum[IncenChY_PTA_YearAgg$Year == 2000])
PTA1 <- "2000"
# How many states in that year?
PTA3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 2000 & FullIncGDP_9715$PTA_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_PTA_control <- FullIncGDP_9715[FullIncGDP_9715$PTA_Dum_CumSum == 0,]
PTA4 <- sum(IncenChy_PTA_control$PTA_Dum_CumSum == 0 & IncenChy_PTA_control$Year == 2015)
PTA5 <- length(unique(IncenChy_PTA_control[IncenChy_PTA_control$PTA_Dum_CumSum == 0 & IncenChy_PTA_control$Year == 2015,]$State))
# The Year with the most policy adoptions for PTA is 1994. In this year, 45 industries in 1 state adopted PTA. Could compare against 927 across 28 states that never adopted.
Incentive <- "PTA"
DiD_Year <- PTA1
Treatment_Industries <- PTA2
Treatment_States <- PTA3
Control_Industries <- PTA4
Control_States <- PTA5
DiDEstimators4 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
# CJTS
IncenChY_CJTS <- FullIncGDP_9715[FullIncGDP_9715$CJTS_Dum_CumSum == 1,]
names(IncenChY_CJTS)
IncenChY_CJTS_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_CJTS[c(7, 26)], sum))
IncenChY_CJTS_YearAgg <- IncenChY_CJTS_YearAgg[IncenChY_CJTS_YearAgg$Year > 1996,]
CJTS1 <- IncenChY_CJTS_YearAgg$Year[which.max(IncenChY_CJTS_YearAgg$CJTS_Dum_CumSum)]
CJTS2 <- max(IncenChY_CJTS_YearAgg$CJTS_Dum_CumSum)
# How many states in that year?
CJTS3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 2001 & FullIncGDP_9715$CJTS_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_CJTS_control <- FullIncGDP_9715[FullIncGDP_9715$CJTS_Dum_CumSum == 0,]
CJTS4 <- sum(IncenChy_CJTS_control$CJTS_Dum_CumSum == 0 & IncenChy_CJTS_control$Year == 2015)
CJTS5 <- length(unique(IncenChy_CJTS_control[IncenChy_CJTS_control$CJTS_Dum_CumSum == 0 & IncenChy_CJTS_control$Year == 2015,]$State))
# The Year with the most policy adoptions for CJTS is 1993. In this year, 93 industries across 3 states adopted CJTS. Could compare against 599 in 27 states that never adopted.
Incentive <- "CJTS"
DiD_Year <- CJTS1
Treatment_Industries <- CJTS2
Treatment_States <- CJTS3
Control_Industries <- CJTS4
Control_States <- CJTS5
DiDEstimators5 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
DiDEstimators <- rbind(DiDEstimators1, DiDEstimators2, DiDEstimators3, DiDEstimators4, DiDEstimators5)
write.table(DiDEstimators, file = "DiDEstimators.txt", sep = ",", quote = FALSE, row.names = F)
FullIncGDP_9715$StateInd <- paste(FullIncGDP_9715$State, FullIncGDP_9715$Industry, sep = " ")
# JCTC
IncentivesJCTC10 <- FullIncGDP_9715 %>%
group_by(Year, JCTC_Dum_CumSum) %>%
summarize(cumsumcount = n())
IncentivesJCTC10 <- IncentivesJCTC10[IncentivesJCTC10$JCTC_Dum_CumSum == 0 | IncentivesJCTC10$JCTC_Dum_CumSum==1,]
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 0] <- c("No Adoption")
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 1] <- c("Adopted (First time)")
ggplot(IncentivesJCTC10, aes(x=factor(Year), y= cumsumcount, fill=factor(JCTC_Dum_CumSum))) + geom_bar(stat="identity", position = "dodge") + annotate("text", x= 8, y= 660, label = "2004", color = 'red') + scale_fill_brewer(palette = "Dark2")+ labs(y = "Number of State-Industries", x = "Year", title= "Figure 1: Vizualization of Potential DiD Year Cutoff for Job Creation Tax Credit", caption = "Source: Bartik 2017", fill = "Adoption") + geom_text(aes(label=cumsumcount), position=position_dodge(width=0.9), vjust=-0.25) + annotate("rect", xmin=7.45, xmax=8.67, ymin=0 , ymax=680, alpha=0.2, color="blue", fill="blue")
library(ggplot2)
library(reshape)
library(stargazer)
library(plm)
library(dplyr)
# JCTC
IncentivesJCTC10 <- FullIncGDP_9715 %>%
group_by(Year, JCTC_Dum_CumSum) %>%
summarize(cumsumcount = n())
IncentivesJCTC10 <- IncentivesJCTC10[IncentivesJCTC10$JCTC_Dum_CumSum == 0 | IncentivesJCTC10$JCTC_Dum_CumSum==1,]
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 0] <- c("No Adoption")
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 1] <- c("Adopted (First time)")
library(dplyr)
# Eliminate leading spaces stemming from hierarchies in BEABLS Data
BEABLS_longst$Industry <- trimws(BEABLS_longst$Industry, which = "both")
# Export and Check Text of Industry Names
unique(BEABLS_longst$Industry)
unique(Incentives2$Industry)
# Get just the annual state GDPs for later merge
BEABLS_longststates <- BEABLS_longst[BEABLS_longst$Industry == "All industry total",]
# Merge Full
FullIncGDP_9015 <- left_join(Incentives2, BEABLS_longst, by = c("State", "Industry", "Year"))
FullIncGDP_9715 <- FullIncGDP_9015[FullIncGDP_9015$Year > 1996,]
# Eliminate industries without matching GDP Data
FullIncGDP_9715 <- FullIncGDP_9715[!is.na(FullIncGDP_9715$GDP),]
write.csv(FullIncGDP_9715, "Full Merged Dataset NAICS 102518.csv")
########################## DiD Checks - New ################
# Load in data
FullIncGSP_9715 <- read.csv("Full Merged Dataset NAICS 102518.csv", stringsAsFactors = FALSE)
# JCTC
IncenChY_JCTC <- FullIncGDP_9715[FullIncGDP_9715$JCTC_Dum_CumSum == 1,]
names(IncenChY_JCTC)
IncenChY_JCTC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_JCTC[c(7, 22)], sum))
IncenChY_JCTC_YearAgg$Year[which.max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum)]
JCTC1 <- 2004
JCTC2 <- max(IncenChY_JCTC_YearAgg$JCTC_Dum_CumSum[IncenChY_JCTC_YearAgg$Year == 2004])
# How many states in that year?
JCTC3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 2004 & FullIncGDP_9715$JCTC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_JCTC_control <- FullIncGDP_9715[FullIncGDP_9715$JCTC_Dum_CumSum == 0,]
JCTC4 <- sum(IncenChy_JCTC_control$JCTC_Dum_CumSum == 0 & IncenChy_JCTC_control$Year == 2015)
JCTC5 <- length(unique(IncenChy_JCTC_control[IncenChy_JCTC_control$JCTC_Dum_CumSum == 0 & IncenChy_JCTC_control$Year == 2015,]$State))
# If we look at just post 1997 when the data merges, 2004 appears to bt the best year. In this year, 62  industries across states adopted JCTC. Would be able to potentially compare against 637 in 30 states that never adopt.
Incentive <- "JCTC"
DiD_Year <- JCTC1
Treatment_Industries <- JCTC2
Treatment_States <- JCTC3
Control_Industries <- JCTC4
Control_States <- JCTC5
DiDEstimators1 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
###### ITC
IncenChY_ITC <- FullIncGDP_9715[FullIncGDP_9715$ITC_Dum_CumSum == 1,]
names(IncenChY_ITC)
IncenChY_ITC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_ITC[c(7, 23)], sum))
IncenChY_ITC_YearAgg <- IncenChY_ITC_YearAgg[IncenChY_ITC_YearAgg$Year > 1996,]
ITC1 <- IncenChY_ITC_YearAgg$Year[which.max(IncenChY_ITC_YearAgg$ITC_Dum_CumSum)]
ITC2 <- max(IncenChY_ITC_YearAgg$ITC_Dum_CumSum)
# How many states in that year?
ITC3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 1998 & FullIncGDP_9715$ITC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_ITC_control <- FullIncGDP_9715[FullIncGDP_9715$ITC_Dum_CumSum == 0,]
ITC4 <- sum(IncenChy_ITC_control$ITC_Dum_CumSum == 0 & IncenChy_ITC_control$Year == 2015)
ITC5 <- length(unique(IncenChy_ITC_control[IncenChy_ITC_control$ITC_Dum_CumSum == 0 & IncenChy_ITC_control$Year == 2015,]$State))
# The Year with the most policy adoptions for ITC is 1995. In this year, 100 industries across 4 states adopted ITC. Could compare against 865 in 31 states that never adopt.
Incentive <- "ITC"
DiD_Year <- ITC1
Treatment_Industries <- ITC2
Treatment_States <- ITC3
Control_Industries <- ITC4
Control_States <- ITC5
DiDEstimators2 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
##### RDC
IncenChY_RDC <- FullIncGDP_9715[FullIncGDP_9715$RDC_Dum_CumSum == 1,]
names(IncenChY_RDC)
IncenChY_RDC_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_RDC[c(7, 24)], sum))
IncenChY_RDC_YearAgg <- IncenChY_RDC_YearAgg[IncenChY_RDC_YearAgg$Year > 1996,]
RDC1 <- IncenChY_RDC_YearAgg$Year[which.max(IncenChY_RDC_YearAgg$RDC_Dum_CumSum)]
RDC2 <- max(IncenChY_RDC_YearAgg$RDC_Dum_CumSum)
# How many states in that year?
RDC3 <- length(unique(Incentives[FullIncGDP_9715$Year == 2000 & FullIncGDP_9715$RDC_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_RDC_control <- FullIncGDP_9715[FullIncGDP_9715$RDC_Dum_CumSum == 0,]
RDC4 <- sum(IncenChy_RDC_control$RDC_Dum_CumSum == 0 & IncenChy_RDC_control$Year == 2015)
RDC5 <- length(unique(IncenChy_RDC_control[IncenChy_RDC_control$RDC_Dum_CumSum == 0 & IncenChy_RDC_control$Year == 2015,]$State))
# The Year with the most policy adoptions for RDC is 2000. In this year, 134 industries across 4 states adopted RDC. Could compare against 460 across 25 states that never adopt.
Incentive <- "RDC"
DiD_Year <- RDC1
Treatment_Industries <- RDC2
Treatment_States <- RDC3
Control_Industries <- RDC4
Control_States <- RDC5
DiDEstimators3 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
##### PTA
IncenChY_PTA <- FullIncGDP_9715[FullIncGDP_9715$PTA_Dum_CumSum == 1,]
names(IncenChY_PTA)
IncenChY_PTA_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_PTA[c(7, 25)], sum))
IncenChY_PTA_YearAgg <- IncenChY_PTA_YearAgg[IncenChY_PTA_YearAgg$Year > 1996,]
IncenChY_PTA_YearAgg$Year[which.max(IncenChY_PTA_YearAgg$PTA_Dum_CumSum)]
PTA2 <- max(IncenChY_PTA_YearAgg$PTA_Dum_CumSum[IncenChY_PTA_YearAgg$Year == 2000])
PTA1 <- "2000"
# How many states in that year?
PTA3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 2000 & FullIncGDP_9715$PTA_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_PTA_control <- FullIncGDP_9715[FullIncGDP_9715$PTA_Dum_CumSum == 0,]
PTA4 <- sum(IncenChy_PTA_control$PTA_Dum_CumSum == 0 & IncenChy_PTA_control$Year == 2015)
PTA5 <- length(unique(IncenChy_PTA_control[IncenChy_PTA_control$PTA_Dum_CumSum == 0 & IncenChy_PTA_control$Year == 2015,]$State))
# The Year with the most policy adoptions for PTA is 1994. In this year, 45 industries in 1 state adopted PTA. Could compare against 927 across 28 states that never adopted.
Incentive <- "PTA"
DiD_Year <- PTA1
Treatment_Industries <- PTA2
Treatment_States <- PTA3
Control_Industries <- PTA4
Control_States <- PTA5
DiDEstimators4 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
# CJTS
IncenChY_CJTS <- FullIncGDP_9715[FullIncGDP_9715$CJTS_Dum_CumSum == 1,]
names(IncenChY_CJTS)
IncenChY_CJTS_YearAgg <- as.data.frame(aggregate(. ~ Year, IncenChY_CJTS[c(7, 26)], sum))
IncenChY_CJTS_YearAgg <- IncenChY_CJTS_YearAgg[IncenChY_CJTS_YearAgg$Year > 1996,]
CJTS1 <- IncenChY_CJTS_YearAgg$Year[which.max(IncenChY_CJTS_YearAgg$CJTS_Dum_CumSum)]
CJTS2 <- max(IncenChY_CJTS_YearAgg$CJTS_Dum_CumSum)
# How many states in that year?
CJTS3 <- length(unique(FullIncGDP_9715[FullIncGDP_9715$Year == 2001 & FullIncGDP_9715$CJTS_Dum_CumSum == 1,]$State))
##### Calculating for Control
IncenChy_CJTS_control <- FullIncGDP_9715[FullIncGDP_9715$CJTS_Dum_CumSum == 0,]
CJTS4 <- sum(IncenChy_CJTS_control$CJTS_Dum_CumSum == 0 & IncenChy_CJTS_control$Year == 2015)
CJTS5 <- length(unique(IncenChy_CJTS_control[IncenChy_CJTS_control$CJTS_Dum_CumSum == 0 & IncenChy_CJTS_control$Year == 2015,]$State))
# The Year with the most policy adoptions for CJTS is 1993. In this year, 93 industries across 3 states adopted CJTS. Could compare against 599 in 27 states that never adopted.
Incentive <- "CJTS"
DiD_Year <- CJTS1
Treatment_Industries <- CJTS2
Treatment_States <- CJTS3
Control_Industries <- CJTS4
Control_States <- CJTS5
DiDEstimators5 <- data.frame(Incentive, DiD_Year, Treatment_Industries, Treatment_States, Control_Industries, Control_States)
DiDEstimators <- rbind(DiDEstimators1, DiDEstimators2, DiDEstimators3, DiDEstimators4, DiDEstimators5)
# JCTC
IncentivesJCTC10 <- FullIncGDP_9715 %>%
group_by(Year, JCTC_Dum_CumSum) %>%
summarize(cumsumcount = n())
IncentivesJCTC10 <- IncentivesJCTC10[IncentivesJCTC10$JCTC_Dum_CumSum == 0 | IncentivesJCTC10$JCTC_Dum_CumSum==1,]
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 0] <- c("No Adoption")
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 1] <- c("Adopted (First time)")
# JCTC
IncentivesJCTC10 <- FullIncGDP_9715 %>%
group_by(Year, JCTC_Dum_CumSum) %>%
summarize(cumsumcount = n())
IncentivesJCTC10 <- IncentivesJCTC10[IncentivesJCTC10$JCTC_Dum_CumSum == 0 | IncentivesJCTC10$JCTC_Dum_CumSum==1,]
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 0] <- c("No Adoption")
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 1] <- c("Adopted (First time)")
ggplot(IncentivesJCTC10, aes(x=factor(Year), y= cumsumcount, fill=factor(JCTC_Dum_CumSum))) + geom_bar(stat="identity", position = "dodge") + annotate("text", x= 8, y= 660, label = "2004", color = 'red') + scale_fill_brewer(palette = "Dark2")+ labs(y = "Number of State-Industries", x = "Year", title= "Figure 1: Vizualization of Potential DiD Year Cutoff for Job Creation Tax Credit", caption = "Source: Bartik 2017", fill = "Adoption") + geom_text(aes(label=cumsumcount), position=position_dodge(width=0.9), vjust=-0.25) + annotate("rect", xmin=7.45, xmax=8.67, ymin=0 , ymax=680, alpha=0.2, color="blue", fill="blue")
library(plyr)
IncentivesJCTC10 <- FullIncGDP_9715 %>%
group_by(Year, JCTC_Dum_CumSum) %>%
summarize(cumsumcount = n())
IncentivesJCTC10 <- IncentivesJCTC10[IncentivesJCTC10$JCTC_Dum_CumSum == 0 | IncentivesJCTC10$JCTC_Dum_CumSum==1,]
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 0] <- c("No Adoption")
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 1] <- c("Adopted (First time)")
ggplot(IncentivesJCTC10, aes(x=factor(Year), y= cumsumcount, fill=factor(JCTC_Dum_CumSum))) + geom_bar(stat="identity", position = "dodge") + annotate("text", x= 8, y= 660, label = "2004", color = 'red') + scale_fill_brewer(palette = "Dark2")+ labs(y = "Number of State-Industries", x = "Year", title= "Figure 1: Vizualization of Potential DiD Year Cutoff for Job Creation Tax Credit", caption = "Source: Bartik 2017", fill = "Adoption") + geom_text(aes(label=cumsumcount), position=position_dodge(width=0.9), vjust=-0.25) + annotate("rect", xmin=7.45, xmax=8.67, ymin=0 , ymax=680, alpha=0.2, color="blue", fill="blue")
library(dplyr)
# JCTC
IncentivesJCTC10 <- FullIncGDP_9715 %>%
group_by(Year, JCTC_Dum_CumSum) %>%
summarize(cumsumcount = n())
IncentivesJCTC10 <- IncentivesJCTC10[IncentivesJCTC10$JCTC_Dum_CumSum == 0 | IncentivesJCTC10$JCTC_Dum_CumSum==1,]
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 0] <- c("No Adoption")
IncentivesJCTC10$JCTC_Dum_CumSum[IncentivesJCTC10$JCTC_Dum_CumSum == 1] <- c("Adopted (First time)")
ggplot(IncentivesJCTC10, aes(x=factor(Year), y= cumsumcount, fill=factor(JCTC_Dum_CumSum))) + geom_bar(stat="identity", position = "dodge") + annotate("text", x= 8, y= 660, label = "2004", color = 'red') + scale_fill_brewer(palette = "Dark2")+ labs(y = "Number of State-Industries", x = "Year", title= "Figure 1: Vizualization of Potential DiD Year Cutoff for Job Creation Tax Credit", caption = "Source: Bartik 2017", fill = "Adoption") + geom_text(aes(label=cumsumcount), position=position_dodge(width=0.9), vjust=-0.25) + annotate("rect", xmin=7.45, xmax=8.67, ymin=0 , ymax=680, alpha=0.2, color="blue", fill="blue")
names(FullDataSet)
FullDataSet$NoIncentivesTab <- Incentives$JCTC_Dum <- ifelse(FullDataSet$JCTC_Dum_CumSum > 0 | FullDataSet$ITC_Dum_CumSum > 0 | FullDataSet$RDC_Dum_CumSum > 0 | FullDataSet$PTA_Dum_CumSum > 0 | FullDataSet$CJTS_Dum_CumSum > 0), 1, 0)
FullDataSet$NoIncentivesTab <- ifelse(FullDataSet$JCTC_Dum_CumSum > 0 | FullDataSet$ITC_Dum_CumSum > 0 | FullDataSet$RDC_Dum_CumSum > 0 | FullDataSet$PTA_Dum_CumSum > 0 | FullDataSet$CJTS_Dum_CumSum > 0), 1, 0)
FullDataSet$NoIncentivesTab <- ifelse((FullDataSet$JCTC_Dum_CumSum > 0 | FullDataSet$ITC_Dum_CumSum > 0 | FullDataSet$RDC_Dum_CumSum > 0 | FullDataSet$PTA_Dum_CumSum > 0 | FullDataSet$CJTS_Dum_CumSum > 0), 1, 0)
table(FullDataSet$NoIncentivesTab)
library(MatchIt)
fmla <- as.formula(NoIncentivesTab ~ SAEMHI_PT + SAEOVRTALL_PT + PCTUI_PT + AnnualWagesFullState + AnnualSubsFullState + EnnualECFullState + AnnualPercoFullState + Personal.income..millions.of.dollars. +  Net.earnings.by.place.of.residence + Personal.current.transfer.receipts + Income.maintenance.benefits.1. + Unemployment.insurance.compensation + Retirement.and.other + Dividends..interest..and.rent + Personal.dividend.income + Personal.interest.income + Imputed.interest.receipts.2. + Monetary.interest.receipts + Rental.income.of.persons + Imputed.rent + Monetary.rent + Population..persons..3. + Per.capita.incomes..dollars. + Per.capita.personal.income.4. + Per.capita.net.earnings.4. + Per.capita.personal.current.transfer.receipts.4.. + Per.capita.income.maintenance.benefits.4. + Per.capita.unemployment.insurance.compensation.4. + Per.capita.retirement.and.other.4. + Per.capita.dividends..interest..and.rent.4. + Per.capita.dividends.4. + Per.capita.interest.4. + Per.capita.rent.4. + Earnings.by.place.of.work + Wages.and.salaries + Supplements.to.wages.and.salaries + Employer.contributions.for.employee.pension.and.insurance.funds.5. + Employer.contributions.for.government.social.insurance + Proprietors..income + Farm.proprietors..income + Farm.proprietors..income +  Nonfarm.proprietors..income + Total.employment..number.of.jobs. +  Wage.and.salary.employment + Proprietors.employment + Farm.proprietors.employment.6. + Nonfarm.proprietors.employment + Average.earnings.per.job..dollars. + Average.wages.and.salaries + Average.nonfarm.proprietors..income)
m.out = matchit(formula = fmla,
data = FullDataSet, method = "nearest",
ratio = 1)
m.out = matchit(formula = fmla,
data = FullDataSet, method = "nearest",
ratio = 1, na.action = na.omit)
m.out = matchit(formula = fmla,
data = FullDataSet(na.omit), method = "nearest",
ratio = 1)
m.out = matchit(formula = fmla,
data = FullDataSet, method = "nearest",
ratio = 1)
sapply(FullDataSet, function(x) sum(is.na(x)))
View(FullDataSet)
install.packages('Amelia')
library(Amelia)
library(Amelia)
install.packages('Amelia', dependencies = TRUE)
library(Amelia)
sapply(FullDataSet, function(x) sum(is.na(x)))
names(FullDataSet)
names(FullDataSet)[4] <- "Industry"
names(FullDataSet)
Imputed_Full_data_long <-amelia(FullDataSet,ts= 'Year', cs= c('STABREV', 'Industry') , p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type'))
FullDataSet <- FullDataSet[,-c(47, 49, 51, 66, 77)]
names(FullDataSet)
Imputed_Full_data_long <-amelia(FullDataSet,ts= 'Year', cs= c('STABREV', 'Industry') , p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type'))
Imputed_Full_data_long <-amelia(FullDataSet,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type'))
FullDataSet$AnnualWages <- as.numeric(FullDataSet$AnnualWages)
FullDataSet$AnnualEC <- as.numeric(FullDataSet$AnnualEC)
Imputed_Full_data_long <-amelia(FullDataSet,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type'))
Imputed_Full_data_long <-amelia(FullDataSet,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type', 'STABREV', 'Industry', 'StateFull', 'StateInd'))
names(FullDataSet)
FullDataSetim <- FullDataSet[,-c(83:85, 89:95)]
Imputed_Full_data_long <-amelia(FullDataSetim,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type', 'STABREV', 'Industry', 'StateFull', 'StateInd'))
sapply(FullDataSet, function(x) sum(is.na(x)))
sapply(FullDataSetim, function(x) sum(is.na(x)))
Imputed_Full_data_long <-amelia(FullDataSetim,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('Manufacturing.Industry', 'Ratio.Type', 'STABREV', 'Industry', 'StateFull', 'StateInd'))
names(FullDataSet)
FullDataSetim <- FullDataSet[,-c(3, 5, 6:7, 9, 10:36, 83:85, 89:95)]
Imputed_Full_data_long <-amelia(FullDataSetim,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('STABREV', 'Industry'))
names(FullDataSetim)
View(FullDataSetim)
FullDataSetim <- FullDataSet[,-c(3, 5, 6:7, 9, 10:36, 83:85, 89:96)]
names(FullDataSetim)
Imputed_Full_data_long <-amelia(FullDataSetim,ts= 'Year', cs= 'X', p2s=0, intercs = FALSE, idvars=c('STABREV', 'Industry'))
FullDataSetDiD <- FullDataSet[FullDataSet$Year == 1998 | FullDataSet$Year == 2016,]
View(FullDataSetDiD)
unique(FullDataSet)
unique(FullDataSet$Year)
FullDataSetDiD <- FullDataSet[FullDataSet$Year == 1998 | FullDataSet$Year == 2015,]
